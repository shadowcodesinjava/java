package com.example.myapplication; // IMPORTANT: Make sure this matches your project folder name!

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {

    TextView screen;
    double num1 = 0, num2 = 0;
    String operator = "";
    boolean isNewOp = true;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // This line links the Java to the XML file above
        setContentView(R.layout.activity_main);

        screen = findViewById(R.id.screen);

        // List of all button IDs defined in your XML
        int[] ids = {
                R.id.btn0, R.id.btn1, R.id.btn2, R.id.btn3, R.id.btn4, R.id.btn5, R.id.btn6,
                R.id.btn7, R.id.btn8, R.id.btn9, R.id.btn00, R.id.btnDec, R.id.btnPlus,
                R.id.btnMinus, R.id.btnMult, R.id.btnDiv, R.id.btnRem, R.id.btnAC, R.id.btnDel, R.id.btnEq
        };

        // Assigning the click listener to every button in the list
        for (int id : ids) {
            View btn = findViewById(id);
            if (btn != null) {
                btn.setOnClickListener(this::onButtonClick);
            }
        }
    }

    public void onButtonClick(View view) {
        Button b = (Button) view;
        String text = b.getText().toString();

        switch (text) {
            case "AC":
                screen.setText("0");
                num1 = 0;
                isNewOp = true;
                break;
            case "DL":
                String val = screen.getText().toString();
                if (val.length() > 1) {
                    screen.setText(val.substring(0, val.length() - 1));
                } else {
                    screen.setText("0");
                }
                break;
            case "+": case "-": case "*": case "/": case "%":
                num1 = Double.parseDouble(screen.getText().toString());
                operator = text;
                isNewOp = true;
                break;
            case "=":
                num2 = Double.parseDouble(screen.getText().toString());
                double result = 0;
                switch (operator) {
                    case "+": result = num1 + num2; break;
                    case "-": result = num1 - num2; break;
                    case "*": result = num1 * num2; break;
                    case "/": result = num1 / num2; break;
                    case "%": result = num1 % num2; break;
                }
                screen.setText(String.valueOf(result));
                isNewOp = true;
                break;
            default: // Handles 0-9, 00, and dot
                if (isNewOp || screen.getText().toString().equals("0")) {
                    screen.setText(text);
                } else {
                    screen.append(text);
                }
                isNewOp = false;
                break;
        }
    }
}
